name: Java CI with Maven test
on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
     - uses: actions/checkout@v2
     - name: Set up JDK 11
       uses: actions/setup-java@v2
       with:
        java-version: '11'
        distribution: 'adopt'
     - name: Install Maven
       run: sudo apt-get install maven -y
     - name: Start Selenium server
       run: |
        wget https://selenium-release.storage.googleapis.com/3.141/selenium-server-standalone-3.141.59.jar
        nohup java -jar selenium-server-standalone-3.141.59.jar > /dev/null 2>&1 &

     - name: Run Selenium tests
       run: mvn clean test -Dtest=TestSuite

     - name: Stop Selenium server
       run: curl -X POST http://localhost:4444/selenium-server/driver/?cmd=shutDownSeleniumServer
